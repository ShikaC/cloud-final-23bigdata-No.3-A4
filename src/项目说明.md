# 云计算虚拟化与容器化性能对比实验 (Cloud Final)

## 项目简介

本项目通过实验对比 **VMWare 虚拟机** 和 **Docker 容器** 的性能差异。我们选取了 Nginx Web 服务器作为基准测试应用，对比了以下关键指标：
- **资源效率**：启动时间、CPU 占用、内存占用、磁盘占用。
- **并发性能**：QPS (每秒请求数)、平均响应时间、传输速率。

## 快速运行指南

只需三步，即可在您的 Ubuntu/Debian 环境中运行完整实验。

### 1. 克隆项目并进入目录

```bash
git clone <项目地址>
cd cloud_final/src
```

### 2. 运行一键实验脚本

```bash
# 赋予执行权限并运行
chmod +x *.sh
bash run_experiment.sh
```

**该脚本将自动完成：**
- ✓ **环境检查与安装**：检测并安装 Nginx, Docker, Python 及其依赖。
- ✓ **VM 性能采集**：获取当前运行虚拟机的各项基准指标。
- ✓ **Docker 自动化测试**：拉取 Nginx 镜像，启动并采集容器性能。
- ✓ **压力测试对比**：使用 Apache Bench (ab) 对两者进行高并发压测。
- ✓ **数据分析与可视化**：生成 Markdown 分析报告和 **交互式 HTML 可视化图表**。

### 3. 查看实验结果

实验结束后，结果将保存在 `results/` 目录下：
- **可视化图表**：`results/visualization/`
  - `performance_comparison.html` (双击浏览器打开，交互式查看启动时间、资源占用)
  - `stress_comparison.html` (双击浏览器打开，交互式查看压测 QPS 和延迟)
- **分析报告**：`results/analysis_report.md` (详细的对比数据与场景建议)
- **原始数据**：`results/performance.csv` 和 `results/stress.csv`

---

## 技术细节

### 项目结构

```text
src/
├── run_experiment.sh         # 主运行脚本 (入口)
├── install_dependencies.sh   # 依赖安装脚本
├── vm_test.sh                # VM 基准采集
├── docker_test.sh            # Docker 容器化测试
├── stress_test.sh            # 并发压测脚本
├── analyze_results.py        # 结果汇总分析
├── visualize_results.py      # 生成 HTML 交互式图表
├── utils.py                  # 公用工具函数
├── cleanup.sh                # 环境清理脚本
└── requirements.txt          # Python 依赖列表
```

### 环境要求

- **操作系统**：Ubuntu 20.04+ (推荐), Debian 11+
- **权限**：需要 `sudo` 权限以安装依赖和运行 Docker
- **网络**：需要连接互联网以下载 Docker 镜像和 pip 包

## 常见问题 (FAQ)

- **Q: 为什么生成的图表是 HTML 而不是图片？**
  - A: 使用 HTML (Plotly) 可以彻底避免 Matplotlib 在 Linux 环境下的中文乱码问题，同时支持缩放和数据提示，查看更清晰。
- **Q: 端口冲突怎么办？**
  - A: 脚本支持自动寻找可用端口，运行 `bash run_experiment.sh --auto-port` 即可。
- **Q: 想要清理测试产生的容器？**
  - A: 运行 `bash cleanup.sh` 即可恢复环境。

